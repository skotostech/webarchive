<!!!!!!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<title>Notes from the Dawn of Time</title>		<meta name="Author" content="FreeFrog Designs (ffdesigns.com)">
		<style TYPE="text/css"><!--BODY, P, TD {	font-size: 12px;	font-family: Verdana, Helvetica, Arial, sans-serif;}H1 {	font-size: 24px;	font-family: Verdana, Helvetica, Arial, sans-serif;}H2 {	font-size: 18px;	font-family: Verdana, Helvetica, Arial, sans-serif;}H3 {	font-size: 14px;	font-family: Verdana, Helvetica, Arial, sans-serif;}PRE, CODE {	font-size: 12px;	font-family: Courier New, Courier, monospace;}--></style>
	</head>	<body background="../artwork/skoot_back.jpg" link="#006633" vlink="#cc3300" alink="#990066" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" text="black">		<center>
			<img src="nav/tnav_dawnof.gif" width="531" height="90" align="BOTTOM" alt="topnav" border="0" hspace="10" vspace="10" usemap="#tnav_dawnof"><map name="tnav_dawnof"><area shape="rect" coords="351,65,519,79" href="../games/succession.html" target="_top"><area shape="rect" coords="350,50,519,63" href="../games/eternal-city.html" target="_top"><area shape="rect" coords="348,33,519,48" href="../games/marrach.html" target="_top"><area shape="rect" coords="261,60,328,89" href="../vbulletin/index.html"><area shape="rect" coords="196,4,250,28" href="../storybuilders/Intro.shtml.html" target="_top"><area shape="rect" coords="11,65,181,77" href="bestof.shtml.html"><area shape="rect" coords="11,49,181,63" href="ArticlesArchive.shtml.html"><area shape="rect" coords="11,35,181,47" href="DAWNOF.shtml.html"><area shape="rect" coords="349,7,517,30" href="../games/m59.html" target="_top"><area shape="rect" coords="10,5,182,32" href="show-column.phtml%3Fcolname=playing.html" target="_top"></map><br>
			<table border="0" cellpadding="2" width="90%" height="90">				<tr>					<td valign="top">						<div align="left">							<h2><font color="#006633"><a href="DAWNOF.shtml.html"><img src="nav/snav_dawnof.gif" width="137" height="334" align="right" hspace="10" vspace="10" border="0" alt="Series Info..."></a><b>Notes from the Dawn of Time #7:</b></font></h2>
							<h2><b>Matching</b></h2>
							<p><b><i>by <a href="mailto:richard@mud.co.uk">Richard Bartle<br>										</a>November 28, 2001</i></b></p>
							<p>Last time, I showed what the inheritance hierarchy looked like for functions. However, I drew it as a tree, rather than as a full hierarchy. Now I&#146;m going to explain why. (You might want to <a href="artwork/dawnof6b.gif" target="_blank">refer to the tree</a> as I go through this).</p>
							<p>In theory, { dexterity player } should have both { dexterity creature } and {&nbsp;attribute&nbsp;player&nbsp;} as parents, because in the atom hierarchy DEXTERITY is a kind of ATTRIBUTE and PLAYER is a kind of CREATURE. Nevertheless, I only gave it one parent, { dexterity creature }. The reason for this is because of an inheritance clash.</p>
							<p>As { dexterity player } has no code defined for itself, it must inherit it from one of its parents. Strictly speaking, the choice is arbitrary, but in practice it doesn&#146;t matter so long as it always chooses to inherit from the same parent (remember how I used this line of argument when talking about the advantages of multiple inheritance over single inheritance?).</p>
		<p>In the example, I chose to make [ dexterity player ]() inherit from {&nbsp;dexterity&nbsp;creature&nbsp;}. This was not an arbitrary decision: I used an algorithm. I did this because programmers need to know the order in which code will be evaluated, so things like output come in the right order. Thus, I matched atoms in a function call left-to-right against definitions, choosing the most specific first. DEXTERITY is an exact match against DEXTERITY but is in a subclass relationship with ATTRIBUTE, therefore the code for { dexterity creature } would be found before that for { attribute player } from a call to [ dexterity player ]().</p>
							<p>It&#146;s possible to inherit both, of course. For example, the code for {&nbsp;drop&nbsp;penny&nbsp;} might be exactly the same as for {&nbsp;drop&nbsp;object&nbsp;} except that it prints a message first (&quot;The penny drops&quot;). It seems sensible, therefore, to make {&nbsp;drop&nbsp;penny&nbsp;} a subclass of {&nbsp;drop&nbsp;object&nbsp;} that prints the message and then inherits the general code defined for { drop object } to perform the actual dropping function. This would give it a <i>backtracking</i> facility akin to that possessed by the language Prolog.</p>
							<h3><b>Purity versus Pragmatism</b></h3>
							<p>I tried this with <i>MUD2</i>, but rejected it.</p>
							<p>First of all, the backtracking has to be explicit (you had to say &quot;backtrack at this point&quot;, rather than as in Prolog where you&#146;d say &quot;don&#146;t backtrack past this point&quot;); this is because there are so many catch-all error messages (&quot;You can&#146;t drop that!&quot; etc.) that if backtracking were implicit you&#146;d need to switch it off after practically every function call. Explicit backtracking is not necessarily a bad thing in itself, though.</p>
		<p>Secondly, I found that I simply didn&#146;t have much use for it. Implementationally, the overheads involved in keeping track of function call matches just in case a backtrack was asked for at some point were sufficiently great that I dropped the idea so I could write a faster run-time system. It did run faster as a consequence, but I believe this pragmatism to have been a mistake: I later realized that it was possible at compile-time to figure out which functions needed to be backtrackable and which didn&#146;t, which would have let me keep the necessary functionality without burdening the program except when it was going to be used. Oh well, you live and learn!</p>
		<p>The point is, though, that in practice you have to invoke backtracking so infrequently that you don&#146;t really <i>need</i> it at all. A function call has to match but one definition, and therefore it effectively has only one parent. Although {&nbsp;dexterity&nbsp;player&nbsp;} matches both { dexterity creature } and { attribute player }, if it only ever inherits code from { dexterity creature } then effectively it doesn&#146;t have {&nbsp;attribute&nbsp;player&nbsp;} as a parent at all. <i>That&#146;s</i> why I didn&#146;t draw the connection in the OOP hierarchy.</p>
							<p>Advocates of single inheritance who haven&#146;t gone to sleep by now are permitted at this point to smirk and say, &quot;See! You used it in the end!&quot;.</p>
							<h3><b>Methods</b></h3>
							<p>I guess I&#146;d better explain what we have now, given that I&#146;m bound to have lost most readers somewhere along the way with my incoherent ramblings...</p>
							<p>Things in the game (what you might colloquially call &quot;objects&quot;) are represented by <i>atoms</i>. They are arranged in a multiple inheritance hierarchy, the <i>atom hierarchy</i>. Atoms have no methods directly associated with them.</p>
		<p>Examples: PENNY, COIN, MONEY, TREASURE, OBJECT.</p>
		<p>Also in the atom hierarchy are atoms representing actions and verbs. These don&#146;t have any methods associated with them either.</p>
							<p>Examples: SMITE, HIT, KILL, ACTION.</p>
							<i>Functions</i> do have methods associated with them. A function definition is a list of atoms from the atom hierarchy, plus the associated <i>executable code</i>. This executable code is the only method a function ever has.
							<p>Example: { density penny }: [ mass penny ]()/[ volume penny ]()</p>
							<p>When a function is called, if that function is defined exactly then its associated code is executed. Otherwise, the function inherits the code it is to execute from a superior function in the <i>OOP</i> hierarchy (or <i>function hierarchy</i>). A left-to-right, most-specific-first match of atoms in the call against atoms in the definitions determines which function&#146;s code is to be inherited.</p>
							<p>And that&#146;s what it&#146;s taken me 6 articles to derive.</p>
							<h3><b>Summary</b></h3>
							<p>The above system describes what I designed and implemented for <i>MUD2</i> in 1985, as the core of my programming language, MUDDLE. I can&#146;t believe there aren&#146;t far better languages to use for writing MUDs, but then I can scarcely believe that most MUDs today are written using approaches quite as archaic as they are! I don&#146;t expect anyone to use my solutions for improvement, or even to adapt them, but if people at least look at different ways to advance MUD engine design, well, that&#146;s enough for me.</p>
							<p>Next article I&#146;ll tidy up a few remaining loose ends with inheritance, which will hopefully lead seamlessly to a new topic entirely...</p>
							<div align="left">
								<div align="left">								<div align="left">									<div align="left">										<table width="100%">											<tr>												<td align="center" valign="middle">													<p><b>Recent Discussions on <i>Notes from the Dawn of Time</i>:</b></p>												</td>											</tr>											<tr>												<td align="center" valign="middle">													<p><!--#include file="dawnof-last10.php"--></p>												</td>											</tr>											<tr>												<td align="center" valign="middle"><b><a href="http://forum.skotos.net/forumdisplay.php?s=&forumid=33"><img height="20" width="98" src="artwork/jumpto.gif" border="0" alt="jump" align="absmiddle"></a> <a href="http://forum.skotos.net/newthread.php?s=&action=newthread&forumid=33"><img height="20" width="98" src="artwork/postnew.gif" border="0" alt="new" align="absmiddle"></a></b></td>											</tr>										</table>									</div>								</div>							</div>
							</div>
											</td>				</tr>			</table>
			<p></p>
		</center>	</body></html>